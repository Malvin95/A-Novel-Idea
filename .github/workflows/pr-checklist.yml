name: Dynamic PR Checklist
on:
  pull_request:
    types: [opened, edited, labeled]

jobs:
  update-pr-checklist:
    runs-on: ubuntu-latest
    steps:
      - name: Determine checklist type
        id: determine
        run: |
          if [[ "${{ github.head_ref }}" == feature/* ]]; then
            echo "type=feature" >> $GITHUB_OUTPUT
          elif [[ "${{ github.head_ref }}" == bugfix/* ]]; then
            echo "type=bugfix" >> $GITHUB_OUTPUT
          elif [[ "${{ github.head_ref }}" == chore/* ]]; then
            echo "type=chore" >> $GITHUB_OUTPUT
          else
            echo "type=other" >> $GITHUB_OUTPUT
          fi

      - name: Update PR body
        uses: peter-evans/create-or-update-comment@v3
        with:
          issue-number: ${{ github.event.pull_request.number }}
          body: |
            ### âœ… Auto Checklist (for ${{ steps.determine.outputs.type }})

            ${{ steps.determine.outputs.type == 'feature' && '
            - [ ] Code implements new feature
            - [ ] Unit tests created and passing
            - [ ] Storybook updated
            ' || '' }}

            ${{ steps.determine.outputs.type == 'bugfix' && '
            - [ ] Bug reproduced and verified
            - [ ] Regression tests added
            ' || '' }}
